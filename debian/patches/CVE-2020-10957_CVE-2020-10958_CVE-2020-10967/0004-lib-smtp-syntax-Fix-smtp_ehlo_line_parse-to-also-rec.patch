From f78dbaca924bd7e950052a6dcfd9e3edc6c30193 Mon Sep 17 00:00:00 2001
From: Stephan Bosch <stephan.bosch@dovecot.fi>
Date: Mon, 3 Dec 2018 18:45:17 +0100
Subject: [PATCH 04/17] lib-smtp: syntax: Fix smtp_ehlo_line_parse() to also
 record the last parameter.

---
 src/lib-smtp/smtp-syntax.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/lib-smtp/smtp-syntax.c b/src/lib-smtp/smtp-syntax.c
index 23b5d5a4bd..bf8a3f6904 100644
--- a/src/lib-smtp/smtp-syntax.c
+++ b/src/lib-smtp/smtp-syntax.c
@@ -229,6 +229,8 @@ static int smtp_parse_ehlo_line(struct smtp_parser *parser,
 	}
 
 	if (params_r != NULL) {
+		param = p_strdup_until(parser->pool, pbegin, parser->cur);
+		array_append(&params, &param, 1);
 		array_append_zero(&params);
 		*params_r = array_idx(&params, 0);
 	}
-- 
2.11.0

