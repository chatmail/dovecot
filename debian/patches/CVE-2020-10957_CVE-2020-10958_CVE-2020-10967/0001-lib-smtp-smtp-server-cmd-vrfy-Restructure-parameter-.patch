From 4a530313b8376aa4a2153143cd1a9b3a82791555 Mon Sep 17 00:00:00 2001
From: Stephan Bosch <stephan.bosch@open-xchange.com>
Date: Tue, 24 Mar 2020 21:05:17 +0100
Subject: [PATCH 01/17] lib-smtp: smtp-server-cmd-vrfy - Restructure parameter
 parsing.

---
 src/lib-smtp/smtp-server-cmd-vrfy.c | 16 +++++++---------
 1 file changed, 7 insertions(+), 9 deletions(-)

diff --git a/src/lib-smtp/smtp-server-cmd-vrfy.c b/src/lib-smtp/smtp-server-cmd-vrfy.c
index 7f750b82cb..5642604757 100644
--- a/src/lib-smtp/smtp-server-cmd-vrfy.c
+++ b/src/lib-smtp/smtp-server-cmd-vrfy.c
@@ -17,15 +17,13 @@ void smtp_server_cmd_vrfy(struct smtp_server_cmd_ctx *cmd,
 	int ret;
 
 	/* vrfy = "VRFY" SP String CRLF */
-	if ((ret=smtp_string_parse(params, &param, &error)) <= 0) {
-		if (ret < 0) {
-			smtp_server_reply(cmd,
-				501, "5.5.4",
-				"Invalid string parameter: %s", error);
-		} else {
-			smtp_server_reply(cmd,
-				501, "5.5.4", "Invalid parameters");
-		}
+	ret = smtp_string_parse(params, &param, &error);
+	if (ret < 0) {
+		smtp_server_reply(cmd, 501, "5.5.4",
+				  "Invalid string parameter: %s", error);
+		return;
+	} else if (ret == 0) {
+		smtp_server_reply(cmd, 501, "5.5.4", "Invalid parameters");
 		return;
 	}
 
-- 
2.11.0

