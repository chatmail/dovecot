From: =?utf-8?q?Christian_G=C3=B6ttsche?= <cgzones@googlemail.com>
Date: Sun, 31 May 2020 01:34:20 +0200
Subject: fix compiler warnings:

* passing null to format argument
* -Wstringop-truncation
---
 src/lib-http/http-server-private.h | 4 ++--
 src/lib-imap/test-imap-url.c       | 3 +--
 src/lib-master/master-instance.c   | 2 +-
 src/lib-ntlm/ntlm-encrypt.c        | 3 ++-
 src/master/sd-daemon.c             | 4 ++--
 5 files changed, 8 insertions(+), 8 deletions(-)

Index: dovecot/src/master/sd-daemon.c
===================================================================
--- dovecot.orig/src/master/sd-daemon.c
+++ dovecot/src/master/sd-daemon.c
@@ -344,7 +344,7 @@ int sd_notify(int unset_environment, con
                 return 0;
 
         /* Must be an abstract socket, or an absolute path */
-        if ((e[0] != '@' && e[0] != '/') || e[1] == 0) {
+        if ((e[0] != '@' && e[0] != '/') || e[1] == 0 || strlen(e) > (sizeof(sockaddr.un.sun_path)-1)) {
                 r = -EINVAL;
                 goto finish;
         }
@@ -356,7 +356,7 @@ int sd_notify(int unset_environment, con
 
         memset(&sockaddr, 0, sizeof(sockaddr));
         sockaddr.sa.sa_family = AF_UNIX;
-        strncpy(sockaddr.un.sun_path, e, sizeof(sockaddr.un.sun_path));
+        strncpy(sockaddr.un.sun_path, e, sizeof(sockaddr.un.sun_path)-1);
 
         if (sockaddr.un.sun_path[0] == '@')
                 sockaddr.un.sun_path[0] = 0;
